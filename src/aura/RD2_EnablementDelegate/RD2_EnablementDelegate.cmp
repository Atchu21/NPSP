<aura:component controller="RD2_EnablementDelegate_CTRL"
    implements="force:appHostable,lightning:hasPageReference,lightning:isUrlAddressable" access="global">


    <aura:attribute name="isEnableConfirmed" type="Boolean" default="false"
        description="Indicates if enhanced Recurring Donations enablement is confirmed" />
    <aura:attribute name="isEnabled" type="Boolean" default="false"
        description="Indicates if enhanced Recurring Donations have been enabled" />
    <aura:attribute name="isMetaDeployLaunched" type="Boolean" default="false"
        description="Indicates if MetaDeploy has been launched" />
    <aura:attribute name="isMetaDeployConfirmed" type="Boolean" default="false"
        description="Indicates if MetaDeploy has been completed" />
    <aura:attribute name="isMigrationRun" type="Boolean" default="false"
        description="Indicates if data migration has been completed" />

    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:handler event="force:refreshView" action="{!c.refreshView}" />


    <lightning:layout horizontalAlign="spread" multipleRows="true" class="slds-hide" aura:id="enablement-disabled">
        <lightning:layoutItem padding="horizontal-large" size="10">
            <div class="slds-illustration slds-illustration_large">
                <br /><br />
                <img src="/img/chatter/OpenRoad.svg" class="slds-illustration__svg" alt="OpenRoad" />
                <div class="slds-text-longform">
                    <h3 class="slds-text-heading_medium">{!$Label.c.RD2_EnablementDisabledHeader}</h3>
                    <p class="slds-text-body_regular">{!$Label.c.RD2_EnablementDisabledMessage}</p>
                </div>
            </div>
        </lightning:layoutItem>
    </lightning:layout>


    <lightning:layout horizontalAlign="spread" multipleRows="true" class="slds-hide" aura:id="enabler">

        <lightning:layoutItem padding="horizontal-large" size="12">
            <lightning:formattedRichText class="slds-text-longform" value="{!$Label.c.RD2_EnablementIntro}" />
        </lightning:layoutItem>

        <lightning:layoutItem padding="horizontal-small" class="slds-p-top_medium" size="12">
            <lightning:card title="{!$Label.c.RD2_EnablementPrepTitle}" class="page-section" aura:id="prep-title">
                <lightning:layout multipleRows="true">
                    <lightning:layoutItem padding="horizontal-large" size="12">
                        <lightning:formattedRichText class="slds-text-longform"
                            value="{!$Label.c.RD2_EnablementPrepTasks}" />
                    </lightning:layoutItem>
                </lightning:layout>
            </lightning:card>
        </lightning:layoutItem>

        <lightning:layoutItem padding="horizontal-small" size="12">
            <lightning:card title="{!$Label.c.RD2_EnablementEnableTitle}" class="page-section" aura:id="enablement">
                <div class="slds-p-horizontal_large slds-progress slds-progress_vertical">
                    <ol class="slds-progress__list">
                        <li
                            class="{!'slds-progress__item ' + if(v.isEnableConfirmed, 'slds-is-completed', 'slds-is-active')}">
                            <div
                                class="{!'slds-progress__marker ' + if(v.isEnableConfirmed, 'slds-progress__marker_icon slds-progress__marker_icon-success', '')}">
                                <aura:if isTrue="{!v.isEnableConfirmed}">
                                    <lightning:icon iconName="utility:success" class="slds-icon-text-default"
                                        size="x-small" />
                                </aura:if>
                            </div>

                            <div class="slds-progress__item_content slds-grid slds-gutters">
                                <div class="slds-col slds-size_10-of-12">
                                    <label for="enable-confirm">
                                        <lightning:formattedRichText value="{!$Label.c.RD2_EnablementEnableConfirm}" />
                                    </label>
                                </div>
                                <div class="slds-col slds-size_2-of-12 slds-p-left_small">
                                    <lightning:input type="checkbox-button"
                                        label="{!$Label.c.RD2_EnablementEnableConfirm}" aura:id="enable-confirm"
                                        name="enable-confirm" checked="{!v.isEnableConfirmed}"
                                        onchange="{!c.onEnableConfirm}" />
                                </div>
                            </div>
                        </li>

                        <li class="{!'slds-progress__item ' + if(v.isEnabled, 'slds-is-completed', 'slds-is-active')}">
                            <div
                                class="{!'slds-progress__marker ' + if(v.isEnabled, 'slds-progress__marker_icon slds-progress__marker_icon-success', '')}">
                                <aura:if isTrue="{!v.isEnabled}">
                                    <lightning:icon iconName="utility:success" class="slds-icon-text-default"
                                        size="x-small" />
                                </aura:if>
                            </div>

                            <div class="slds-progress__item_content slds-grid slds-gutters">
                                <div class="slds-col slds-size_10-of-12">
                                    <lightning:formattedRichText value="{!$Label.c.RD2_EnablementEnableMessage}" />
                                    &nbsp;
                                    <lightning:icon iconName="utility:warning" alternativeText="warning" size="xx-small"
                                        class="slds-icon-text-default" variant="warning" />
                                    &nbsp;
                                    <lightning:formattedRichText value="{!$Label.c.RD2_EnablementEnableWarning}" />
                                </div>
                                <div class="slds-col slds-size_2-of-12 slds-p-left_small">
                                    <lightning:input type="toggle" label="{!$Label.c.RD2_EnablementEnableMessage}"
                                        variant="label-hidden" aura:id="enable-toggle" name="enable-toggle"
                                        checked="{!v.isEnabled}" onchange="{!c.onEnabled}"
                                        messageToggleActive="{!$Label.c.ToggleEnabled}"
                                        messageToggleInactive="{!$Label.c.ToggleDisabled}">
                                    </lightning:input>
                                </div>
                            </div>
                        </li>

                    </ol>
                </div>
            </lightning:card>
        </lightning:layoutItem>

        <lightning:layoutItem padding="horizontal-small" size="12">
            <lightning:card title="{!$Label.c.RD2_EnablementMetaDeployTitle}" class="page-section" aura:id="metadeploy">
                <div class="slds-p-horizontal_large slds-progress slds-progress_vertical">
                    <ol class="slds-progress__list">
                        <li
                            class="{!'slds-progress__item ' + if(v.isMetaDeployLaunched, 'slds-is-completed', 'slds-is-active')}">
                            <div
                                class="{!'slds-progress__marker ' + if(v.isMetaDeployLaunched, 'slds-progress__marker_icon slds-progress__marker_icon-success', '')}">
                                <aura:if isTrue="{!v.isMetaDeployLaunched}">
                                    <lightning:icon iconName="utility:success" class="slds-icon-text-default"
                                        size="x-small" />
                                </aura:if>
                            </div>

                            <div class="slds-progress__item_content slds-grid slds-gutters">
                                <div class="slds-col slds-size_10-of-12">
                                    <lightning:formattedRichText value="{!$Label.c.RD2_EnablementMetaDeployLaunch}" />
                                </div>
                                <div class="slds-col slds-size_2-of-12 slds-p-left_small">
                                    <lightning:formattedUrl aura:id="metadeploy-link" name="metadeploy-link"
                                        value="https://install.salesforce.org/products/npsp-rd2-pilot"
                                        tooltip="{!$Label.c.RD2_EnablementMetaDeployLaunchLinkLabel}"
                                        label="{!$Label.c.RD2_EnablementMetaDeployLaunchLinkLabel}" target="_blank" />
                                </div>
                            </div>
                        </li>

                        <li
                            class="{!'slds-progress__item ' + if(v.isMetaDeployConfirmed, 'slds-is-completed', 'slds-is-active')}">
                            <div
                                class="{!'slds-progress__marker ' + if(v.isMetaDeployConfirmed, 'slds-progress__marker_icon slds-progress__marker_icon-success', '')}">
                                <aura:if isTrue="{!v.isMetaDeployConfirmed}">
                                    <lightning:icon iconName="utility:success" class="slds-icon-text-default"
                                        size="x-small" />
                                </aura:if>
                            </div>

                            <div class="slds-progress__item_content slds-grid slds-gutters">
                                <div class="slds-col slds-size_10-of-12">
                                    <lightning:formattedRichText value="{!$Label.c.RD2_EnablementMetaDeployConfirm}" />
                                </div>
                                <div class="slds-col slds-size_2-of-12 slds-p-left_small">
                                    <lightning:input type="checkbox-button"
                                        label="{!$Label.c.RD2_EnablementMetaDeployConfirm}" aura:id="metadeploy-confirm"
                                        name="metadeploy-confirm" checked="{!v.isMetaDeployConfirmed}"
                                        onchange="{!c.onMetaDeployConfirm}" />
                                </div>
                            </div>
                        </li>

                    </ol>
                </div>
            </lightning:card>
        </lightning:layoutItem>

        <lightning:layoutItem padding="horizontal-small" size="12">
            <lightning:card title="{!$Label.c.RD2_EnablementMigrationTitle}" class="page-section" aura:id="migration">
                <lightning:layout multipleRows="true">
                    <lightning:layoutItem padding="horizontal-large" size="10">
                        <lightning:formattedRichText value="{!$Label.c.RD2_EnablementMigrationRun}" />
                    </lightning:layoutItem>
                    <lightning:layoutItem size="2">
                        <lightning:button label="{!$Label.c.RD2_EnablementMigrationRunButton}" variant="neutral"
                            disabled="{!or(!v.isMetaDeployConfirmed, v.isMigrationRun)}" />
                    </lightning:layoutItem>
                    <lightning:layoutItem padding="horizontal-large" class="slds-p-top_small" size="10">
                        <lightning:icon iconName="utility:warning" alternativeText="warning" size="xx-small"
                            class="slds-icon-text-default" variant="warning" />&nbsp;
                        <lightning:formattedRichText value="{!$Label.c.RD2_EnablementMigrationWarning}" />
                    </lightning:layoutItem>
                    <lightning:layoutItem size="2" />
                </lightning:layout>
            </lightning:card>
        </lightning:layoutItem>
    </lightning:layout>

</aura:component>