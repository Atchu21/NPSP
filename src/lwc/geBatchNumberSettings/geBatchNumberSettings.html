<template>
    <template if:true={permissionEnabled}>
        <lightning-layout class="slds-m-around_x-large"
                          multiple-rows="true">

            <lightning-layout-item size="12"
                                   class="slds-m-vertical_small">
                <div class="slds-section slds-is-open">
                    <h3 class="slds-section__title slds-theme_shade slds-m-bottom_small">
                        <span class="slds-truncate slds-p-horizontal_small"
                              title={labels.header}>
                            {labels.header}
                        </span>
                    </h3>
                    <div aria-hidden="false"
                         class="slds-section__content">
                        <template if:true={error}>
                            <c-util-page-level-message variant="error"
                                                       title="Error">
                                <p slot="body"
                                   class="slds-m-bottom_small slds-text-color_destructive">
                                    There was an error creating a batch number format.
                                    Please review and try again.
                                    {errorMessage}
                                </p>
                            </c-util-page-level-message>
                        </template>
                        <p class="slds-text-body_regular">{labels.description}</p>
                    </div>
                </div>
            </lightning-layout-item>

            <lightning-layout-item size="12">
                <h3 class="slds-text-title slds-text-title_bold slds-text-color_default">
                    {labels.headerConfigure}
                </h3>
                <p class="slds-text-body_regular slds-p-vertical_small">
                    {labels.descriptionConfigure}
                </p>
                <c-util-expandable-section label={labels.headerDisplayFormat}
                                           is-collapsed="true"
                                           button-background="none">
                    <lightning-formatted-text
                            value={labels.descriptionDisplayFormat}></lightning-formatted-text>
                </c-util-expandable-section>
            </lightning-layout-item>

            <lightning-layout-item size="12"
                                   class="slds-m-bottom_small">
                <lightning-layout multiple-rows="true" horizontal-align="left">

                    <lightning-layout-item size="12" medium-device-size="4"
                                           padding="around-small">
                        <lightning-input type="text"
                                         name={labelDisplayFormat}
                                         label={labelDisplayFormat}
                                         field-level-help={inlineHelpTextDisplayFormat}
                                         value={displayFormat}
                                         max-length="30"
                                         required
                                         placeholder={displayNumberPlaceholder}
                                         onchange={handleDisplayFormatChange}
                                         onblur={handleDisplayFormatBlur}
                                         data-qa-locator={qaLocatorDisplayFormat}>
                        </lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="12" medium-device-size="4"
                                           padding="around-small">
                        <lightning-input type="number"
                                         name={labelStartingNumber}
                                         label={labelStartingNumber}
                                         field-level-help={inlineHelpTextStartingNumber}
                                         value={startingNumber}
                                         onchange={handleStartingNumberChange}
                                         data-qa-locator={qaLocatorStartingNumber}
                                         max-length="10">
                        </lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="12" medium-device-size="4"
                                           padding="around-small">
                        <lightning-input type="text"
                                         name={labelDescription}
                                         label={labelDescription}
                                         field-level-help={inlineHelpTextDescription}
                                         value={description}
                                         onchange={handleDescriptionChange}
                                         data-qa-locator={qaLocatorDescription}>
                        </lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="12"
                                           padding="horizontal-small">
                        <lightning-button variant="brand"
                                          label={labels.buttonSave}
                                          title={labels.buttonSave}
                                          onclick={handleCreateBatchNumber}
                                          data-qa-locator={qaLocatorCreateBatchNumberFormatButton}>
                        </lightning-button>
                    </lightning-layout-item>

                </lightning-layout>
            </lightning-layout-item>

            <lightning-layout-item size="12"
                                   class="slds-m-vertical_small">
                <h3 class="slds-text-title slds-text-title_bold slds-text-color_default">
                    {labels.headerFormats}
                </h3>
                <p class="slds-text-body_regular slds-p-vertical_small">
                    {labels.descriptionActivation}
                </p>

                <lightning-datatable key-field="id"
                                     data={autoNumberRecords}
                                     columns={columns}
                                     onrowaction={handleRowAction}
                                     hide-checkbox-column="true"
                                     is-loading={isLoading}
                                     data-qa-locator={qaLocatorBatchNumberDatatable}>
                </lightning-datatable>
            </lightning-layout-item>

        </lightning-layout>
    </template>
</template>